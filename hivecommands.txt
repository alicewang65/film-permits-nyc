0. Set-up
Make sure you know where the data files for the zip code output and average building valuation
output are located on HDFS. Make sure you're connected to peel as well.

1. Connect to Hive from peel
beeline
!connect jdbc:hive2://hm-1.hpc.nyu.edu:10000/
[At this point you'll be prompted to enter your username and password]
use <net_id>;

2. Create an external table for the zip code count output
CREATE EXTERNAL TABLE filmpermits(zipcode STRING, count INT) COMMENT "film permit info" 
ROW FORMAT DELIMITED FIELDS TERMINATED BY "," STORED AS TEXTFILE LOCATION "/user/YOURNETID/<LOCATION OF FILE IN HDFS>";

3.. Create an external table for the average valuation output
CREATE EXTERNAL TABLE avgvaluations(zipcode STRING, valuation DOUBLE) COMMENT "average building valuation info" 
ROW FORMAT DELIMITED FIELDS TERMINATED BY "," STORED AS TEXTFILE LOCATION "/user/YOURNETID/<LOCATION OF FILE IN HDFS>";

4. Check to make sure tables were correctly created
describe filmpermits;
describe avgvaluations;

5. Execute join query on the tables
SELECT filmpermits.zipcode, filmpermits.count, avgvaluations.valuation 
FROM filmpermits JOIN avgvaluations ON (filmpermits.zipcode = avgvaluations.zipcode);

6. If you want to save the output the join query from step (5) to HDFS, run the following command
insert overwrite directory "/user/YOURNETID/<DIRECTORY WILL OVERWRITE>"
SELECT filmpermits.zipcode, filmpermits.count, avgvaluations.valuation 
FROM filmpermits JOIN avgvaluations ON (filmpermits.zipcode = avgvaluations.zipcode);